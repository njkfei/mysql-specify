# mysql-specify
mysql编码规范
## 0. 背景
* 多
* 少
* 乱

造成的影响：
* 增加手写代码工作量
* 效率低下
* 影响性能

## 1.命名规范
* 1 [强制]库名、表名、字段名必须使用小写字母，“_”分割。
> 解释：自动生成代码用
* 2 [推荐]应有id，且是自增主键
> 解释：自动生成代码用
* 3 [强制]数据表、数据字段必须加入中文注释
> 解释：一字段多用，这种情况，后来人沮奔

## 2. 设计规范
* 4 [强制]必须使用InnoDB存储引擎
* 5 [强制]必须有惟一键
> 解释：哪怕是自增的id,必须要有一个
* 6 [强制]存储精确浮点数必须使用DECIMAL替代FLOAT和DOUBLE。
>　解释，FLOAT和DOUBLE存储浮点数，显示的时候，很痛苦
* 7 [强制]必须使用TINYINT来代替ENUM类型
> 解释,ENUM内部就是int
* 8 [强制]整形定义中不添加长度，比如使用INT，而不是INT(4)。
* 9 [建议]时间存储使用long,不使用timestamp,在应用层做控制
> 解释：mysql只做存储的事情．业务数据在业务做
* 10 [强制]禁止在数据库中使用VARBINARY、BLOB存储图片、文件．
> 解释：会浪费更多的磁盘和内存空间，非必要的大量的大字段查询会淘汰掉热数据，导致内存命中率急剧降低，影响数据库性能
* 11 必须把字段定义为NOT NULL并且提供默认值
> 解释：
```
a）null的列使索引/索引统计/值比较都更加复杂，对MySQL来说更难优化

b）null 这种类型MySQL内部需要进行特殊处理，增加数据库处理记录的复杂性；同等条件下，表中有较多空字段的时候，数据库的处理性能会降低很多

c）null值需要更多的存储空，无论是表还是索引中每行中的null的列都需要额外的空间来标识

d）对null 的处理时候，只能采用is null或is not null，而不能采用=、in、<、<>、!=、not in这些操作符号。如：where name!=’shenjian’，如果存在name为null值的记录，查询结果就不会包含name为null值的记录
```
* 12 [强制]字段集必须采用utf-8.
* 13 [推荐]推荐建立create_at,update_at字段．

## 3. 索引规范
* 14 [强制]索引中的字段数建议不超过5个。
* 15 [推荐]ORDER BY，GROUP BY，DISTINCT的字段需要添加在索引的后面。
* 16 [推荐]合理创建联合索引（避免冗余），(a,b,c) 相当于 (a) 、(a,b) 、(a,b,c)。
* 17 [强制]禁止在线上环境使用%前缀模糊查询，例如LIKE “%weibo”。
* [强制]禁止存储过程、触发器、函数
> 解释
```
a) 不利于数据库迁移
b) 数据库不宜包含业务逻辑
c) 最重要一条：大厂都禁止使用
```

## 4. 其它
* 18 [强制]禁止进行联表查询
> 解释：
```
a) 不利于今后服务拆分
b) 存在性能问题
c) 最重要一条：大厂都禁止使用
```
* 19 [建议]不要使用大字段，除非是必须要使用大字段
> 解释：
```
a) 占带宽
b) 引起mysql性能下降
c) 无法进行排序
```
* 20 [建议]字段应有create_at,update_at字段，推荐long型，通过业务层来进行控制。

## 5. 流程规范
* 建立数据库评审流程,新表设计后，应提交DBA进行审核，审核通过后，再入库．
* 尽量在早期设计阶段设计好sql,来优化性能，以避免慢查询出现在线上．
* 定期查看线上慢查询，通过慢查询，发现潜在的性能瓶颈
